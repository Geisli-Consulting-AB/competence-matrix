/* Mobile-specific styles for Competence Matrix */

/* Fix vertical centering issue - override index.css body styles */
body {
  display: flex !important;
  place-items: flex-start !important;
  align-items: flex-start !important;
  justify-content: center !important;
}

/* Mobile breakpoints */
@media (max-width: 768px) {
  /* App container adjustments - 5px gap */
  .MuiContainer-root {
    padding-left: 5px !important;
    padding-right: 5px !important;
    padding-top: 5px !important;
    padding-bottom: 5px !important;
    margin: 0 !important;
    max-width: none !important;
  }

  /* Keep minimal body margins on mobile */
  body {
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Keep minimal root padding */
  #root {
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Header and title adjustments */
  .mobile-title {
    font-size: 2rem !important;
    margin-bottom: 1rem !important;
  }

  .mobile-image {
    max-height: 200px !important;
    margin-bottom: 1rem !important;
  }

  /* Tab navigation for mobile */
  .mobile-tabs {
    min-height: 48px;
  }

  .mobile-tabs .MuiTab-root {
    min-width: 0 !important;
    padding: 6px 8px !important;
    font-size: 0.75rem !important;
  }

  .mobile-tab-panel {
    padding: 8px !important;
  }

  /* Full screen mobile layout */
  .mobile-full-screen {
    width: 100vw !important;
    min-height: 100vh !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Adjust paper components for full screen */
  .MuiPaper-root {
    border-radius: 0 !important;
    margin: 0 !important;
  }

  /* Login button */
  .mobile-login-button {
    width: 100% !important;
    max-width: 280px !important;
  }

  /* Logout button positioning */
  .mobile-logout-container {
    flex-direction: row !important;
    align-items: center !important;
    justify-content: space-between !important;
  }

  .mobile-logout-button {
    margin: 0 8px 0 0 !important;
    font-size: 0.75rem !important;
    padding: 4px 8px !important;
    min-width: auto !important;
  }
}

/* Very small devices: tighten header columns further */
@media (max-width: 360px) {
  /* Narrow vertical header cells to reduce horizontal scroll on ultra-small screens */
  .MuiTableContainer-root
    .MuiTable-root
    .MuiTableHead-root
    .MuiTableRow-root
    .vertical-header-cell,
  .MuiTableContainer-root
    .MuiTable-root
    .MuiTableHead-root
    .MuiTableRow-root
    .MuiTableCell-root.vertical-header-cell,
  table .MuiTableHead-root .MuiTableRow-root .vertical-header-cell {
    width: 32px !important;
    min-width: 32px !important;
    max-width: 32px !important;
    padding: 1px 0 !important;
    font-size: 0.65rem !important;
  }
}

/* Small mobile devices */
@media (max-width: 480px) {
  .mobile-title {
    font-size: 1.5rem !important;
  }

  .mobile-tabs .MuiTab-root {
    font-size: 0.7rem !important;
    padding: 4px 6px !important;
  }

  .mobile-tab-panel {
    padding: 4px !important;
  }
}

/* Category Management mobile styles */
@media (max-width: 768px) {
  .mobile-category-input {
    width: 90% !important;
    max-width: 90% !important;
  }

  .mobile-category-expanded {
    width: 95% !important;
    margin: 0 auto !important;
  }

  .mobile-category-header {
    flex-direction: column !important;
    align-items: center !important;
    gap: 8px !important;
  }

  .mobile-category-title {
    font-size: 1.1rem !important;
    text-align: center !important;
  }

  .mobile-category-actions {
    display: flex !important;
    gap: 8px !important;
  }

  .mobile-competence-input {
    width: 100% !important;
  }

  .mobile-competence-chips {
    justify-content: center !important;
  }

  .mobile-competence-chip {
    margin: 2px !important;
    font-size: 0.75rem !important;
  }
}

/* Competence Mapping mobile styles */
@media (max-width: 768px) {
  .mobile-mapping-container {
    overflow-x: hidden !important;
  }

  .mobile-mapping-card {
    margin-bottom: 16px !important;
    padding: 12px !important;
  }

  .mobile-mapping-title {
    font-size: 0.9rem !important;
    font-weight: 600 !important;
    margin-bottom: 8px !important;
  }

  .mobile-mapping-chips {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
    justify-content: flex-start !important;
  }

  .mobile-mapping-chip {
    font-size: 0.75rem !important;
    height: 28px !important;
  }

  /* Hide table on mobile, show cards instead */
  .mobile-hide-table {
    display: none !important;
  }

  .mobile-show-cards {
    display: block !important;
  }
}

/* Competence Table mobile styles */
@media (max-width: 768px) {
  /* Mobile competence card layout */
  .mobile-competence-card {
    margin-bottom: 16px !important;
    border-radius: 8px !important;
  }

  .mobile-competence-card-content {
    padding: 12px !important;
  }

  /* First row: Input field + Delete button */
  .mobile-competence-input-row {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    margin-bottom: 12px !important;
  }

  .mobile-competence-autocomplete {
    flex: 1 !important;
  }

  .mobile-competence-input {
    width: 100% !important;
  }

  .mobile-competence-delete {
    flex-shrink: 0 !important;
    padding: 4px !important;
  }

  /* Second row: Level selection */
  .mobile-competence-level-row {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .mobile-level-label {
    font-size: 0.75rem !important;
    font-weight: 600 !important;
    margin-bottom: 4px !important;
  }

  .mobile-level-radio-group {
    display: flex !important;
    flex-direction: column !important;
    gap: 4px !important;
  }

  .mobile-level-option {
    margin: 0 !important;
    padding: 2px 0 !important;
  }

  .mobile-level-option .MuiFormControlLabel-label {
    font-size: 0.8rem !important;
  }

  .mobile-level-option .MuiRadio-root {
    padding: 4px !important;
  }

  /* Add button styling */
  .mobile-add-competence {
    display: flex !important;
    justify-content: center !important;
    margin-top: 16px !important;
    padding: 8px !important;
    position: sticky !important; /* keep the add button visible */
    bottom: 8px !important;
    z-index: 20 !important;
    background: linear-gradient(
      to top,
      rgba(18, 18, 18, 0.95),
      rgba(18, 18, 18, 0.6)
    ) !important;
  }

  .mobile-add-button {
    background-color: rgba(25, 118, 210, 0.08) !important;
    border: 1px dashed rgba(25, 118, 210, 0.5) !important;
    border-radius: 8px !important;
    padding: 12px !important;
    min-width: 44px !important;
    min-height: 44px !important; /* ensure touch target >=44px */
  }
}

/* Desktop - hide mobile cards */
@media (min-width: 769px) {
  .mobile-show-cards {
    display: none !important;
  }
}

/* General mobile improvements */
@media (max-width: 768px) {
  /* Improve touch targets */
  .MuiIconButton-root {
    padding: 8px !important;
    min-width: 44px !important;
    min-height: 44px !important;
  }

  /* Better spacing for mobile */
  .MuiPaper-root {
    margin-bottom: 8px !important;
  }

  /* Improve text readability */
  .MuiTypography-body2 {
    font-size: 0.875rem !important;
    line-height: 1.4 !important;
  }

  /* Better form inputs on mobile */
  .MuiTextField-root {
    margin-bottom: 8px !important;
  }

  .MuiOutlinedInput-root {
    font-size: 0.875rem !important;
  }

  /* Prevent iOS zoom on focus by keeping input font-size >= 16px */
  .mobile-competence-input .MuiInputBase-input,
  .mobile-filter-row .MuiInputBase-input,
  .MuiTextField-root .MuiInputBase-input {
    font-size: 16px !important;
  }

  /* Filter row layout on mobile */
  .mobile-filter-row {
    gap: 8px !important;
    flex-wrap: wrap !important; /* allow items to wrap so only two sit per row */
  }

  /* Reduce margin-bottom of upper filter wrapper on mobile */
  .mobile-filter-wrapper-upper {
    margin-bottom: 0px !important;
  }

  /* Reduce margin-bottom of lower filter wrapper on mobile */
  .mobile-filter-wrapper-lower {
    margin-bottom: 0px !important;
  }

  /* Unified filter styling - both lines use identical structure now */
  .mobile-filter-row > * {
    width: 50% !important;
    flex: 1 !important;
    max-width: 50% !important;
  }

  /* Actions area (e.g., Clear button) should span full width and align to the right */
  .mobile-filter-actions {
    width: 100% !important;
    max-width: 100% !important;
    display: flex !important;
    justify-content: flex-end !important;
  }

  /* Force all Autocomplete components to take full width of their container */
  .mobile-filter-row .MuiAutocomplete-root {
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Force all TextField components to take full width */
  .mobile-filter-row .MuiTextField-root {
    width: 100% !important;
    max-width: 100% !important;
  }

  /* Override any hardcoded widths in nested components */
  .mobile-filter-row .MuiTextField-root .MuiInputBase-root {
    width: 100% !important;
  }

  .mobile-filter-row .MuiPaper-root {
    width: 100% !important;
    margin: 0 !important;
  }
}

/* iOS Safari and Chrome specific fixes for vertical text */
@media (max-width: 768px) {
  /* Try writing-mode first with maximum iOS compatibility */
  .MuiTableContainer-root
    .MuiTable-root
    .MuiTableHead-root
    .MuiTableRow-root
    .vertical-header-cell,
  .MuiTableContainer-root
    .MuiTable-root
    .MuiTableHead-root
    .MuiTableRow-root
    .MuiTableCell-root.vertical-header-cell,
  table .MuiTableHead-root .MuiTableRow-root .vertical-header-cell {
    /* Use writing-mode with all possible prefixes and fallbacks */
    -webkit-writing-mode: vertical-lr !important;
    -ms-writing-mode: tb-lr !important;
    writing-mode: vertical-lr !important;
    -webkit-text-orientation: mixed !important;
    text-orientation: mixed !important;

    /* Ensure proper table cell behavior */
    display: table-cell !important;

    /* Force proper dimensions */
    width: 40px !important;
    min-width: 40px !important;
    max-width: 40px !important;
    height: auto !important;

    /* Proper cell spacing */
    padding: 4px 2px !important;
    border-left: 1px solid rgba(255, 255, 255, 0.12) !important;
    border-right: 1px solid rgba(255, 255, 255, 0.12) !important;

    /* Text handling */
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    text-align: left !important;
    vertical-align: top !important;

    /* Remove any transforms that might interfere */
    -webkit-transform: none !important;
    transform: none !important;
  }

  /* Fallback for iOS devices specifically */
  @supports (-webkit-touch-callout: none) {
    .vertical-header-cell {
      /* Use CSS transform as fallback but maintain table structure */
      -webkit-writing-mode: horizontal-tb !important;
      writing-mode: horizontal-tb !important;
      -webkit-text-orientation: initial !important;
      text-orientation: initial !important;

      /* Apply transform but keep table cell display */
      -webkit-transform: rotate(90deg) !important;
      transform: rotate(90deg) !important;
      -webkit-transform-origin: center center !important;
      transform-origin: center center !important;

      /* Ensure it stays as a table cell */
      display: table-cell !important;
      width: 40px !important;
      height: 80px !important;
      text-align: center !important;
      vertical-align: middle !important;
    }
  }

  /* Force proper table layout */
  .MuiTableContainer-root .MuiTable-root {
    table-layout: auto !important;
    width: 100% !important;
  }

  .MuiTableContainer-root .MuiTable-root .MuiTableHead-root .MuiTableRow-root {
    display: table-row !important;
  }

  /* Sticky first column for mobile custom layout */
  .mobile-sticky-first-column {
    position: sticky !important;
    left: 0 !important;
    z-index: 10 !important;
    background-color: #121212 !important;
    border-right: 2px solid rgba(255, 255, 255, 0.2) !important;
  }

  .mobile-sticky-row-header {
    position: sticky !important;
    left: 0 !important;
    z-index: 5 !important;
    background-color: inherit !important;
  }
}
